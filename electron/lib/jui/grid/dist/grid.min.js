jui.define("grid.column",["jquery"],function(e){return function(t){this.element=null,this.order=null,this.name=null,this.data=[],this.list=[],this.index=t,this.type="show",this.width=null,this.hide=function(){this.type="hide",e(this.element).hide()},this.show=function(){this.type="show",e(this.element).show()}}}),jui.define("grid.row",["jquery","util.base"],function(h,o){var t=function(){this.data=null,this.seq=0,this.rownum=null,this.index=null,this.element=null,this.list=[],this.hidden={},this.parent=null,this.children=[],this.depth=0,this.type="fold",this.tpl=null,this.init=function(t,e,i){this.data=t,this.tpl=e,this.parent=i}};return t.prototype=new function(){function r(t,e){return t.tpl?(null!=e&&function(t,e){for(var i in t.data)e[i]&&o.typeCheck("string",t.data[i])&&(t.data[i]=t.data[i].replace(/</g,"&lt;").replace(/>/g,"&gt;"))}(t,e),h(t.tpl(h.extend({row:{type:t.type,index:t.index,seq:t.seq,data:t.data,depth:t.depth,children:t.children}},t.data))).get(0)):t.element}function n(t){h(t.element).remove();for(var e=0;e<t.children.length;e++){var i=t.children[e];i.isLeaf()?h(i.element).remove():n(i)}}function l(t){for(var e=0;e<t.length;e++)t[e].setIndex(e),t[e].reload()}this.setIndex=function(t){this.rownum=isNaN(t)?this.rownum:t,this.seq=this.rownum+1,this.parent?this.index=this.parent.index+"."+this.rownum:this.index=""+this.rownum,this.parent&&"string"==typeof this.index&&(this.depth=this.index.split(".").length-1),this.isLeaf()||function t(e){for(var i=e.children,n=0;n<i.length;n++)i[n].setIndex(n),i[n].reload(),i[n].isLeaf()||t(i[n])}(this)},this.reload=function(t,e,i){if(null!=this.element){var n=r(this,i),o=h(this.element).attr("class");h(n).addClass(o).insertAfter(this.element),h(this.element).remove(),this.element=n}else this.element=r(this,i);if(null!=t)for(var s=0;s<t.length;s++)"hide"==t[s].type?this.hideCell(s):this.showCell(s);var l;null!=e&&(this.seq=e),(l=this).list=[],h(l.element).find("td").each(function(t){l.list[t]=this,l.hidden[t]&&(this.style.display="none")})},this.destroy=function(){null!=this.parent?this.parent.removeChild(this.index):(n(this),h(this.element).remove())},this.isLeaf=function(){return 0==this.children.length},this.fold=function(){this.type="fold";for(var t=0;t<this.children.length;t++){var e=this.children[t];h(e.element).hide(),e.isLeaf()||e.fold()}},this.open=function(){this.type="open";for(var t=0;t<this.children.length;t++){var e=this.children[t];h(e.element).show(),e.isLeaf()||e.open()}},this.appendChild=function(t){var e=this.isLeaf()?this.element:this.lastChildLeaf().element;h(t.element).insertAfter(e),this.children.push(t)},this.insertChild=function(t,e,i){var n=this.element;if(0<t){var o=this.children[t-1];n=o.isLeaf()&&this.children.length!=t+1?o.element:o.lastChildLeaf().element}h(e.element).insertAfter(n);var s=this.children.splice(0,t);s.push(e),this.children=s.concat(this.children),l(this.children)},this.removeChild=function(t){for(var e=0;e<this.children.length;e++){var i=this.children[e];i.index==t&&(this.children.splice(e,1),n(i))}l(this.children)},this.lastChild=function(){return this.isLeaf()?null:this.children[this.children.length-1]},this.lastChildLeaf=function(t){var e=t||this.lastChild();return e.isLeaf()?e:this.lastChildLeaf(e.lastChild())},this.showCell=function(t){this.hidden[t]=!1,h(this.list[t]).show()},this.hideCell=function(t){this.hidden[t]=!0,h(this.list[t]).hide()}},t}),jui.define("grid.base",["jquery","util.base","grid.column","grid.row"],function(w,C,x,y){return function(t,o){var u=this,h=t.$obj,l=t.$tpl,r=[],d=[],n={},e=!1,a=C.index();function s(){var e=[];h.thead.find("tr:last > th").each(function(t){e.push(this)});for(var t=0;t<e.length;t++){var i=new x(t);r[t]?(i.element=r[t].element,i.order=r[t].order,i.name=r[t].name,i.data=r[t].data,i.list=r[t].list,i.type=r[t].type,i.width=r[t].width):(i.element=e[t],(w(i.element).attr("width")||w(i.element).attr("style")&&-1!=w(i.element).attr("style").indexOf("width"))&&(i.width=w(i.element).outerWidth()),o&&o[t]&&(i.name=o[t]));for(var n=0;n<d.length;n++)i.list.push(d[n].list[t]),i.data.push(d[n].data[i.name]);r[t]=i}}function c(t,e){if("reload"==t||"append"==t)for(var i=0;i<r.length;i++)r[i].list[e.index]=e.list[i],r[i].data[e.index]=e.data[r[i].name];else if("remove"==t)for(i=0;i<r.length;i++)r[i].list.splice(e.index,1),r[i].data.splice(e.index,1);else s()}function f(t,e,i){if(t instanceof y)return t;var n=new y;return n.init(t,l.row,i),n.setIndex(e),n.reload(r),n}function p(t,e){var i=e.children;if(0<i.length)for(var n=0;n<i.length;n++)t.push(i[n]),0<i[n].children.length&&p(t,i[n])}function m(){var t=arguments[0],e=arguments[1];"function"==typeof t?(e=t,t=0):t=isNaN(t)?0:t;for(var i=t;i<d.length;i++)d[i].setIndex(i),d[i].reload(),c("reload",d[i]),"function"==typeof e&&e(i)}function v(){return"function"==typeof l.none&&(e?0<d.length&&(h.tbody.find("tr:first").remove(),e=!1):0==d.length&&(h.tbody.html(l.none()),e=!0),!0)}function g(t){for(var e=0,i=d.length;e<i;e++)if(d[e].index==""+t)return d[e];return null}this.appendRow=function(){var t,e,i,n,o,s=arguments[0],l=arguments[1],r=null;return l?(t=s,e=l,i=u.getRow(t),n=f(e,i.children.length,i),i.appendChild(n),r=n):(o=f(s,d.length),d.push(o),h.tbody.append(o.element),c("append",o),r=o),v(),r},this.insertRow=function(t,e){var i,n,o,s,l,r,h=null;return a.isIndexDepth(t)?(i=t,n=e,o=a.getIndexList(i),s=u.getRowParent(i),l=o[o.length-1],r=f(n,l,s),s.insertChild(l,r),h=r):h=0==d.length&&0==parseInt(t)?this.appendRow(e):function(t,e){var i=f(e,t),n=i;if(d.length!=t||0==t&&1==d.length)w(i.element).insertBefore(d[t].element);else{var o=d[t-1];w(i.element).insertAfter(0==o.children.length?o.element:o.lastChildLeaf().element)}return(n=d.splice(0,t)).push(i),d=n.concat(d),m(t),i}(t,e),v(),h},this.updateRow=function(t,e){var i=this.getRow(t);for(var n in e)i.data[n]=e[n];return i.reload(),c("reload",i),i},this.moveRow=function(t,e){if(t!=e){var i=this.getRowAll(t),n=i[0],o=C.clone(n.data);if(1<i.length)for(var s=0;s<i.length;s++)t=a.changeIndex(i[s].index,e,i[0].index),this.insertRow(t,i[s].data);else this.insertRow(e,o);this.removeRow(n.index)}},this.removeRow=function(t){var e=this.getRow(t);a.isIndexDepth(t)?e.destroy():(e.destroy(),c("remove",d[t]),d.splice(t,1),m(t)),v()},this.openRow=function(t){for(var e in this.getRow(t).open(),n[t]=!1,n)if(!1!==n[e]){var i=this.getRow(n[e]);null!=i&&i.fold()}},this.openRowAll=function(){for(var t=this.getRowAll(),e=0;e<t.length;e++)t[e].isLeaf()||(t[e].open(),n[t[e].index]=!1)},this.foldRow=function(t){this.getRow(t).fold(),n[t]=t},this.foldRowAll=function(){for(var t=this.getRowAll(),e=0;e<t.length;e++)t[e].isLeaf()||(t[e].fold(),n[t[e].index]=t[e].index)},this.removeRows=function(){d=[],v()||h.tbody.html(""),c()},this.sortRows=function(i,t){var e=C.sort(d);function n(t){var e=t.data[i];return"string"==typeof e?e.toLowerCase():isNaN(e)||null==e?"":e}t?e.setCompare(function(t,e){return n(t)>n(e)}):e.setCompare(function(t,e){return n(t)<n(e)}),e.run(),h.tbody.html(""),m(function(t){h.tbody.append(d[t].element)})},this.appendColumn=function(t,e){var i=r.length,n=w(l[t]({rows:e})),o=n.filter("thead").find("tr");o.each(function(e){var i=h.thead.find("tr").eq(e);w(this).find("th").each(function(t){i.append(this),o.size()-1==e&&r.push({element:this,list:[]})})});for(var s=0;s<d.length;s++)n.filter("tbody").find("tr").eq(s).find("td").each(function(t){w(d[s].element).append(this),r[i+t].list.push(this),d[s].list.push(this),w.extend(d[s].data,e[s])})},this.removeColumn=function(t){for(var e=0;e<r[t].list.length;e++)w(r[t].element).remove(),w(r[t].list[e]).remove();for(var i=0;i<d.length;i++)d[i].list.splice(t,1);r.splice(t,1)},this.hideColumn=function(t){if("hide"!=r[t].type){for(var e=this.getRowAll(),i=0;i<e.length;i++)e[i].hideCell(t);r[t].hide()}},this.showColumn=function(t){if("show"!=r[t].type){for(var e=this.getRowAll(),i=0;i<e.length;i++)e[i].showCell(t);r[t].show()}},this.getColumnCount=function(){return r.length},this.getRowCount=function(){return d.length},this.getColumn=function(t){return null==t?r:r[t]},this.getRow=function(t){if(null==t)return d;if(i=g(t))return i;for(var e=a.getIndexList(t),i=g(e[0]),n=1,o=e.length;n<o&&i;n++)i=i.children[e[n]];return i},this.getRowAll=function(t){for(var e=[],i=null==t?d:[this.getRow(t)],n=0;n<i.length;n++)i[n]&&(e.push(i[n]),0<i[n].children.length&&p(e,i[n]));return e},this.getRowParent=function(t){return a.isIndexDepth(t)?this.getRow(a.getParentIndex(t)):null},this.setColumn=function(t,e){r[t]=e},this.setRow=function(t,e){d[t]=e},this.printInfo=function(){console.log(r),console.log(d)},v(),s()}}),jui.defineUI("grid.table",["jquery","util.base","ui.dropdown","grid.base","grid.row"],function(g,w,C,x,y){w.resize(function(){for(var t=jui.get("grid.table"),e=0;e<t.length;e++)for(var i=t[e],n=0;n<i.length;n++)i[n].resize()},1e3);var t=function(){var f=null,l=null,i=null,d=null,r=null,h=null,n={},p=!1;function a(t,e){for(var i=[],n=0;n<e.length;n++)if("string"==typeof e[n]){var o=t.getColumn(e[n]);i.push(o.index)}else i.push(e[n]);return i}function e(t){var e=t.options.colshow,i=t.uit.getColumnCount();if(!0===e){t.options.colshow=e=[];for(var n=0;n<i;n++)e.push(n)}else e=a(t,e);for(n=0;n<i;n++)-1==g.inArray(n,e)?t.uit.hideColumn(n):t.uit.showColumn(n)}function s(t,e){var i;t.uit.getRowCount()<1||(e&&(t.options.expand&&f.tbody.prepend("<tr class='expand' style='display: none;'><td id='EXPAND_"+t.timestamp+"'></td></tr>"),t.scroll()),t.options.scroll&&(g((i=t).root).hasClass("table-scroll")||i.scroll(),f.tbody.off("scroll").scroll(function(t){if(f.tbody.scrollTop()+i.options.scrollHeight==f.tbody.get(0).scrollHeight)return i.emit("scroll",t),!1})),t.setVo())}function u(t,e){e=e||t.uit.getRow();for(var i,n=0;n<e.length;n++)null!=(i=e[n]).element&&(0<i.children.length?(c(t,i),u(t,i.children)):c(t,i))}function c(o,s){if(o.addEvent(s.element,"click",function(t){if(o.emit("select",[s,t]),o.emit("click",[s,t]),o.options.expand){if(!1===o.options.expandEvent)return;(h instanceof y?h:o.get(h))===s?o.hideExpand(t):(null!=h&&o.hideExpand(t),o.showExpand(s,void 0,t))}}),o.addEvent(s.element,"dblclick",function(t){o.emit("dblclick",[s,t])}),o.addEvent(s.element,"contextmenu",function(t){return o.emit("rowmenu",[s,t]),!1}),o.options.editRow&&o.options.editEvent&&o.addEvent(s.element,"dblclick",function(t){"TD"!=t.target.tagName&&"TR"!=t.target.tagName||o.showEditRow(s.index,t)}),o.options.moveRow){function e(){return g("<tr class='dragline'><td colspan='"+s.list.length+"'></td></tr>")}function i(t,e){if(f.tbody.find(".dragline").remove(),null!=r){if(g("#TABLE_LAYER_"+o.timestamp).remove(),r!=t&&!1!==o.emit("move",[o.get(r),e])){o.move(r,t);var i=o.get(r<t?t-1:t);g(i.element).addClass("dragtarget"),o.hideExpand(e),o.emit("moveend",[i,e])}r=null}}o.addEvent(s.element,"mousedown",function(t){var e,i,n;null==r&&(r=s.index,f.tbody.find("tr").removeClass("dragtarget"),g(s.element).addClass("dragtarget"),g("body").append((e=s.element,i=g("<table id='TABLE_LAYER_"+o.timestamp+"' class='"+g(o.root).attr("class")+" layer'></table>"),n=g(e).clone(),i.css({position:"absolute",width:g(o.root).width(),display:"none"}),n.attr({class:"dragclone"}),i.append(n),i)))}),o.addEvent(s.element,"mouseover",function(t){null!=r&&(f.tbody.find(".dragline").remove(),e().insertBefore(s.element))}),o.addEvent(document,"mouseover",function(t){null!=r&&"TD"!=t.target.tagName&&"TR"!=t.target.tagName&&(f.tbody.find(".dragline").remove(),f.tbody.append(e()))}),o.addEvent(s.element,"mousemove",function(t){null!=r&&g("#TABLE_LAYER_"+o.timestamp).css({left:t.pageX+2,top:t.pageY+2,display:"table"})}),o.addEvent(s.element,"mouseup",function(t){i(s.index,t)}),o.addEvent(f.thead,"mouseover",function(t){i(0,t)}),o.addEvent(document,"mouseup",function(t){i(o.count(),t)})}}function o(n){var i=0,o=f.table.offset(),s=null,l=null,r=0,h=0,u=null;f.thead.find(".resize").remove();for(var t=0;t<n.uit.getColumnCount()-1;t++){var e=g(n.getColumn(t).element),d=g("<div class='resize'></div>"),a=e.offset();d.css({position:"absolute",width:"8px",height:e.outerHeight(),left:e.outerWidth()+(a.left-o.left)-1+"px",top:a.top-o.top+"px",cursor:"w-resize","z-index":"1"}),e.append(d),function(e){n.addEvent(d,"mousedown",function(t){return 0==i&&(i=t.pageX),s=n.getColumn(e),l=c(e),r=g(s.element).outerWidth(),h=g(l.element).outerWidth(),u=this,!(p=!0)})}(t)}function c(t){for(var e=t+1;e<n.uit.getColumnCount();e++){var i=n.getColumn(e).element;if(!g(i).is(":hidden"))return n.getColumn(e)}}n.addEvent(document,"mousemove",function(t){0<i&&function(t,e){if(r+e<30||h-e<30)return;if(g(s.element).outerWidth(r+e),g(l.element).outerWidth(h-e),t.options.scroll){var i=g(l.element).outerWidth()-(s.index==t.uit.getColumnCount()-2?v():0);g(s.list[0]).outerWidth(g(s.element).outerWidth()),g(l.list[0]).outerWidth(i)}}(n,t.pageX-i)}),n.addEvent(document,"mouseup",function(t){if(0<i){i=0;var e=g(s.element).offset().left-o.left;return g(u).css("left",g(s.element).outerWidth()+e-1),n.emit("colresize",[s,t]),setTimeout(function(){p=!1},100),!1}})}function m(t,e){t.hideExpand(),t.hideEditRow(),t.unselect(),e||t.uncheckAll()}function v(){return 0<g(".jui").size()&&w.browser.webkit?10:w.scrollWidth()}this.init=function(){var t=this.options;if(t.data=null!=t.rows?t.rows:t.data,f={table:g(this.root).css({position:"relative"}),thead:g(this.root).find("thead"),tbody:g(this.root).find("tbody")},this.uit=new x({$obj:f,$tpl:this.tpl},t.fields),t.moveRow&&f.tbody.css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none"}),t.fields&&t.colshow&&e(this),t.fields&&this.tpl.menu&&null!=C&&function(n){for(var t=n.listColumn(),e=[],i=0;i<t.length;i++)e.push(g(t[i].element).text());var o=g(n.tpl.menu({columns:e}));g("body").append(o),l=C(o,{close:!1}),g(l.root).find("input[type=checkbox]").each(function(i){"show"==t[i].type?this.checked=!0:this.checked=!1,n.addEvent(this,"click",function(t){var e=g(l.root).find("input[type=checkbox]:checked").size();this.checked?n.showColumn(i,t):0<e?n.hideColumn(i,t):this.checked=!0,n.hideExpand(),n.scroll()})})}(this),t.resize&&o(this),t.fields&&t.sort&&!0===t.sortEvent&&function(n){for(var t=n.options.sort,e=!0===t?n.uit.getColumnCount():t.length,i=0;i<e;i++){var o=!0===t?i:t[i],s=n.getColumn(o);null!=s.element&&(function(e,i){n.addEvent(i.element,"click",function(t){g(t.target).hasClass("resize")||(n.sort(e,void 0,t),n.emit("colclick",[i,t]))})}(o,s),g(s.element).css("cursor","pointer"))}}(this),0<t.data.length?this.update(t.data):this.setVo(),0<t.width&&f.table.outerWidth(t.width),!t.fields&&(t.sort||t.colshow||t.editRow))throw new Error("JUI_CRITICAL_ERR: 'fields' option is required");!function(i){for(var n=i.options,t=i.uit.getColumnCount(),e=0;e<t;e++)!function(t,e){n.fields&&n.sort&&!0===n.sortEvent||i.addEvent(e.element,"click",function(t){i.emit("colclick",[e,t])}),i.addEvent(e.element,"dblclick",function(t){i.emit("coldblclick",[e,t])}),i.addEvent(e.element,"contextmenu",function(t){return i.emit("colmenu",[e,t]),!1})}(0,i.getColumn(e))}(this)},this.update=function(){var t=1==arguments.length?arguments[0]:arguments[1],e=2==arguments.length?arguments[0]:null;null!=e?(c(this,this.uit.updateRow(e,t)),0==parseInt(e)&&this.scroll()):(this.uit.removeRows(),this.scroll(),this.append(t),this.options.sortIndex&&this.sort(this.options.sortIndex,this.options.sortOrder,null))},this.updateTree=function(t){var e=w.index();this.uit.removeRows();for(var i=0;i<t.length;i++){var n=e.getParentIndex(t[i].index);null==n?this.uit.appendRow(t[i].data):this.uit.appendRow(n,t[i].data)}s(this,!0),u(this)},this.append=function(){var t=!(0<this.count()),e=1==arguments.length?arguments[0]:arguments[1],i=2==arguments.length?arguments[0]:null;e=null==e.length?[e]:e;for(var n=0;n<e.length;n++){var o=null;o=null!=i?this.uit.appendRow(i,e[n]):this.uit.appendRow(e[n]),t||c(this,o)}s(this,t),t&&u(this)},this.insert=function(t,e){for(var i=!(0<this.count()),n=(e=null==e.length?[e]:e,0);n<e.length;n++)this.uit.insertRow(t,e[n]);s(this,i),u(this)},this.select=function(t){m(this);var e=this.get(t);return g(e.element).parent().find(".selected").removeClass("selected"),g(e.element).addClass("selected"),i=t,e},this.unselect=function(){if(null!=i){var t=this.get(i);return g(t.element).removeClass("selected"),i=null,t}},this.check=function(t){m(this,!0);var e=this.get(t);this.hideExpand(),this.hideEditRow(),this.unselect(),n[t]=e,g(e.element).addClass("checked")},this.uncheck=function(t){if(null!=n[t]){var e=this.get(t);n[t]=null,g(e.element).removeClass("checked")}},this.uncheckAll=function(){n={},f.tbody.find(".checked").removeClass("checked")},this.remove=function(t){if(null==t)return null;this.uit.removeRow(t),u(this),this.scroll()},this.reset=function(){r=d=h=i=null,n={},this.uit.removeRows(),this.scroll()},this.move=function(t,e){this.uit.moveRow(t,e),u(this),0!=parseInt(t)&&0!=parseInt(e)||this.scroll()},this.sort=function(t,e,i){if(this.options.fields&&this.options.sort&&!p){var n=this.getColumn(t);"string"==typeof n.name&&(n.order=e||("asc"==n.order||null==n.order?"desc":"asc"),this.uit.setColumn(t,n),this.uit.sortRows(n.name,"desc"==n.order),this.emit("sort",[n,i]),s(this,!0),u(this))}},this.scroll=function(t){if(this.options.scroll){var e=this,i=0<(i=t&&0<t?t:this.options.scrollHeight)?i:200;this.options.scrollHeight=i,f.tbody.css("maxHeight",i+"px"),setTimeout(function(){f.tbody.outerHeight()<i?(f.table.css({"table-layout":""}),f.tbody.css({display:"",overflow:""})):(f.table.css({"table-layout":"fixed"}),f.tbody.css({display:"block",overflow:"auto"})),function(t){for(var e=f.table.outerWidth(),i=!1,n=t.uit.getColumnCount()-1;0<=n;n--){var o=t.getColumn(n),s=g(o.element).outerWidth();"none"==g(o.element).css("display")||i||(s-=v(),i=!0),g(o.list[0]).outerWidth(s)}f.tbody.outerWidth(e)}(e)},10)}},this.open=function(t){null!=t&&(this.uit.openRow(t),this.emit("open",[this.get(t)]))},this.fold=function(t){null!=t&&(this.uit.foldRow(t),this.emit("fold",[this.get(t)]))},this.openAll=function(){this.uit.openRowAll(),this.emit("openall")},this.foldAll=function(){this.uit.foldRowAll(),this.emit("foldall")},this.resize=function(){this.scroll(),this.options.resize&&o(this)},this.resizeColumns=function(){for(var t=this.listColumn(),e=0;e<t.length;e++)null==t[e].width&&g(t[e].element).outerWidth("auto")},this.size=function(){return this.uit.getRowCount()},this.count=function(){return this.uit.getRowCount()},this.list=function(){return this.uit.getRow()},this.listData=function(){for(var t=this.list(),e=[],i=0;i<t.length;i++)e.push(t[i].data);return e},this.listAll=function(){return this.uit.getRowAll()},this.listChecked=function(){var t=[];for(var e in n)null!=n[e]&&t.push(n[e]);return t},this.listColumn=function(){return this.uit.getColumn()},this.get=function(t){return null==t?null:this.uit.getRow(t)},this.getAll=function(t){return null==t?null:this.uit.getRowAll(t)},this.getColumn=function(t){return null==t?null:"string"==typeof t?this.uit.getColumn(g.inArray(t,this.options.fields)):this.uit.getColumn(t)},this.showColumn=function(t,e){if(this.options.fields){var i=this.getColumn(t);this.uit.showColumn(i.index),this.scroll(),this.resizeColumns(),this.options.resize&&o(this),this.emit("colshow",[i,e])}},this.hideColumn=function(t,e){if(this.options.fields){var i=this.getColumn(t);this.uit.hideColumn(i.index),this.scroll(),this.resizeColumns(),this.options.resize&&o(this),this.emit("colhide",[i,e])}},this.initColumns=function(t){"object"==typeof t&&(this.options.colshow=t,e(this),this.scroll(),this.resizeColumns(),this.options.resize&&o(this))},this.showColumnMenu=function(t,e){if(this.options.fields&&l){var i=this.listColumn(),n=f.thead.offset(),o=w.typeCheck("integer",t)?t:0,s=w.typeCheck("integer",e)?e:n.top+f.thead.outerHeight();g(l.root).find("input[type=checkbox]").each(function(t){"show"==i[t].type?this.checked=!0:this.checked=!1}),l.move(o,s),l.show()}},this.hideColumnMenu=function(){this.options.fields&&l&&l.hide()},this.toggleColumnMenu=function(t,e){this.options.fields&&l&&("show"==l.type?this.hideColumnMenu():this.showColumnMenu(t,e))},this.showExpand=function(t,e,i){if(this.options.expand){m(this);var n="#EXPAND_"+this.timestamp,o=t instanceof y?t:this.get(t),s=(e="object"!=typeof e?g.extend({row:o},o.data):e,g(n).parent().show());f.tbody.find("tr").removeClass("open"),s.insertAfter(g(o.element).addClass("open")),g(n).attr("colspan",f.thead.find("tr:last > th:visible").size()).html(this.tpl.expand(e)),this.scroll(),this.setVo(),h=t,this.emit("expand",[o,i])}},this.hideExpand=function(t){if(null!=h){var e=h instanceof y?h:this.get(h);g("#EXPAND_"+this.timestamp).parent().hide(),f.tbody.find("tr").removeClass("open"),this.scroll(),h=null,this.emit("expandend",[e,t])}},this.getExpand=function(){return null==h?null:h instanceof y?h:this.get(h)},this.showEditRow=function(t,e){if(this.options.editRow){m(this);var s=this,i=this.get(t),n=g(i.element).find("td");n.each(function(t){!function(t,e,i,n,o,s){var l=t.getColumn(n),r=t.options.editRow,h=null;function u(){null!=d&&s()}!l.name||!0!==r&&-1==g.inArray(n,a(t,r))?(h=g("<div class='edit'></div>").html(g(e).html()||"&nbsp;")).attr("disabled",!0):h=g("<input type='text' class='edit' />").val(l.name?l.data[i.index]:""),g(e).html(h.css("width","100%")),o&&o.target==e&&h.focus(),t.addEvent(h,"keypress",function(t){13==t.which&&u()}),t.addEvent(f.tbody,"mousedown",function(t){"TD"!=t.target.tagName&&"TR"!=t.target.tagName||u()})}(s,this,i,t,e,function(){var o={},t=i.data;n.each(function(t){var e=s.getColumn(t);if(null!=e.name){var i=g(this).find("input.edit");if(1==i.size()){var n=i.val();o[e.name]=isNaN(n)||null==n||""==n?n:parseFloat(n)}}}),i.data=g.extend(i.data,o),!1!==s.emit("editend",[i,e])?s.hideEditRow(o):i.data=t})}),d=t,s.emit("editstart",[i,e])}},this.hideEditRow=function(t){if(null!=d){var e=this.get(d);d=null,this.update(e.index,t||e.data)}},this.getEditRow=function(){return null==d?null:this.get(d)},this.setCsv=function(){var t=this.options;if(t.fields||t.csv){var e=1==arguments.length?arguments[0]:arguments[1],i=2==arguments.length?arguments[0]:null,n=w.getCsvFields(t.fields,t.csv),o=t.csvNumber?w.getCsvFields(t.fields,t.csvNumber):null,s=w.csvToData(n,e,o);if(null==i)this.update(s);else{this.reset();for(var l=0;l<s.length;l++){var r=s[l][i];r&&this.insert(r,s[l])}}}},this.setCsvFile=function(){if(this.options.fields||this.options.csv){var e=this,t=1==arguments.length?arguments[0]:arguments[1],i=2==arguments.length?arguments[0]:null;w.fileToCsv(t,function(t){null==i?e.setCsv(t):e.setCsv(i,t)})}},this.getCsv=function(t){if(this.options.fields||this.options.csv){for(var e=w.getCsvFields(this.options.fields,this.options.csv),i=[],n=t?this.listAll():this.list(),o=0;o<n.length;o++)i.push(n[o].data);return w.dataToCsv2({fields:e,rows:i,names:this.options.csvNames})}},this.getCsvBase64=function(t){if(this.options.fields||this.options.csv)return w.csvToBase64(this.getCsv(t))},this.downloadCsv=function(t,e){w.typeCheck("string",t)&&(t=t.split(".")[0]);var i=document.createElement("a");i.download=t?t+".csv":"table.csv",i.href=this.getCsvBase64(e),document.body.appendChild(i),i.click(),i.parentNode.removeChild(i)},this.activeIndex=function(){return null!=h?h instanceof y?h.index:h:i||d}};return t.setup=function(){return{fields:null,csv:null,csvNames:null,csvNumber:null,data:[],rows:null,colshow:!1,scroll:!1,scrollHeight:200,width:0,expand:!1,expandEvent:!0,editRow:!1,editEvent:!0,resize:!1,sort:!1,sortIndex:null,sortOrder:"asc",sortEvent:!0,moveRow:!1,animate:!1}},t}),jui.defineUI("grid.xtable",["jquery","util.base","ui.modal","grid.table","grid.row"],function(_,k,L,z,W){k.resize(function(){for(var t=jui.get("grid.xtable"),e=0;e<t.length;e++)for(var i=t[e],n=0;n<i.length;n++)i[n].resize()},1e3);var t=function(){var c=null,w=null,u=[],d=[],h=[],l=null,n=null,r=1,i=!1,a=!1,f=8,o=null,s=k.index(),C=null,p=null;function m(t,e,i,n){for(var o=[],s=0,l=t.length;s<l;s++){var r=new W,h=e+s;r.init(t[s],c.tpl.row,i),r.setIndex(h),"open"!=n&&"fold"!=n||(r.type=n),null==i&&(d[h]=r),o.push(r)}return o}function v(o,i,n){var s=o.options,l=!1,r=_(o.root).children(".head"),h=_(o.root).children(".body");o.addEvent(h,"scroll",function(t){if(o.hideColumnMenu(),0<i&&r.scrollLeft(this.scrollLeft),"scroll"==s.buffer){var e=this.scrollTop+n;.9*h.get(0).scrollHeight<=e&&(o.next(),o.emit("scroll",t))}else"vscroll"==s.buffer&&(C.prev_scroll_left==this.scrollLeft?l||(l=!0,setTimeout(function(){!function(t){var e=_(t.root).children(".body"),i=t.options.scrollHeight,n=e.scrollTop(),o=e[0].scrollHeight,s=Math.abs(C.prev_scroll_top-n),l=C.prev_scroll_top<n,r=C.height;if(0==s)return;var h=!1;if(s<i){if(h=!0,0!==s){if(s<r)var u=Math.ceil(s/r);else var u=Math.floor(s/r);0==l?C.current_row_index-=u:C.current_row_index+=u}}else{var d=n/(o-i),a=Math.floor(C.count-C.scroll_count);C.current_row_index=Math.ceil(a*d)}var c=C.current_row_index,f=c,p=r;for(;p<i&&f<C.count;)f++,p+=r;if(p<i)if(i>C.content_height);else{var m=Math.ceil(Math.abs(i-p)/r);c-=m,p+=m*r}if(c<0)return C.prev_scroll_top=0;h&&f!==C.count-1&&(n=Math.ceil(c/C.count*o),e.scrollTop(n),n=e.scrollTop());var v=0,g=i+C.height;o-g<=n&&g<p&&(v=-Math.abs(p-g));C.prev_scroll_top=n,e.css({"max-height":p}),_(w.root).css({top:C.prev_scroll_top+v+"px"}),C.start_index=c,C.end_index=f+1}(o),o.next(),o.emit("scroll",t),l=!1},1)):C.prev_scroll_left=this.scrollLeft);return!1}),"vscroll"==s.buffer&&(_(o.root).hover(function(){C.is_focus=!0},function(){C.is_focus=!1}),o.addEvent(document,"keydown",function(t){if(C.is_focus){var e=h.scrollTop(),i=o.options.rowHeight;if(38==t.which||40==t.which)h.scrollTop(e+(38==t.which?-i:i));else if(33==t.which||34==t.which){var n=i*C.scroll_count;h.scrollTop(e+(33==t.which?-n:n))}}}))}function g(t){var n={},o={},s=0;_(t.root).find("thead .resize").remove();for(var e=0,i=c.uit.getColumnCount();e<i;e++){var l=_(c.getColumn(e).element),r=_("<div class='resize'></div>"),h=l.position(),u=l.outerWidth()+h.left-1;r.css({position:"absolute",width:f+"px",height:l.outerHeight(),left:(e==i-1?u-f:u)+"px",top:h.top+"px",cursor:"w-resize","z-index":"1"}),l.append(r),function(e,i){t.addEvent(r,"mousedown",function(t){return 0==s&&(s=t.pageX),n={head:c.getColumn(e),body:w.getColumn(e),isLast:i},o={column:_(n.head.element).outerWidth(),head:_(c.root).outerWidth(),body:_(w.root).outerWidth(),"max-width":parseInt(_(c.root).parent().css("max-width"))},!(a=!0)})}(e,e==i-1)}t.addEvent(document,"mousemove",function(t){0<s&&function(t){if(o.head+t<o["max-width"])return;if(o.column+t<30)return;_(n.head.element).outerWidth(o.column+t),_(n.body.element).outerWidth(o.column+t),_(c.root).outerWidth(o.head+t),_(w.root).outerWidth(o.body+t)}(t.pageX-s)}),t.addEvent(document,"mouseup",function(t){if(0<s){if(n.isLast){var e=_(w.root).parent().scrollLeft(),i=t.pageX-s;0<i&&(_(c.root).parent().scrollLeft(e+i),_(w.root).parent().scrollLeft(e+i))}return s=0,x(500),c.emit("colresize",[n.head,t]),setTimeout(function(){a=!1},100),!1}}),c.on("colshow",x),c.on("colhide",x)}function x(t){setTimeout(function(){for(var t=0,e=c.uit.getColumnCount();t<e;t++){var i=_(c.getColumn(t).element),n=i.position(),o=i.outerWidth()+n.left-1;i.find(".resize").css("left",(t==e-1?o-f:o)+"px")}},t)}function y(t){return"page"==t.options.buffer?0:k.scrollWidth()+1}function b(t,e,i){for(var n=t.children.length,o=m(k.typeCheck("array",e)?e:[e],n,t,i),s=0,l=o.length;s<l;s++)t.children.push(o[s])}function R(t,e){var i;e?(h=[],function t(e){for(var i=0;i<e.length;i++)h.push(e[i]),"open"==e[i].type&&0<e[i].children.length&&t(e[i].children)}(u)):h=u,"vscroll"==t.options.buffer&&(i=t,C.height=i.options.rowHeight,C.count=h.length,C.scroll_count=Math.floor(i.options.scrollHeight/C.height),C.content_height=C.count*C.height,_(w.root).parent().height(0<C.content_height?C.content_height:"auto"))}function E(t,e,i,n,o){var s="desc"==n[o]?1:0,l=i[o],r=!isNaN(+t[l]-+e[l]),h=r?+t[l]:t[l],u=r?+e[l]:e[l];return r||("string"==typeof h&&(h=h.toLowerCase()),"string"==typeof u&&(u=u.toLowerCase())),h<u?0==s?-1:1:h==u?i.length-1>o?E(t,e,i,n,o+1):0:0==s?1:-1}this.init=function(){var r,t=this.options;if(t.data=null!=t.rows?t.rows:t.data,"TABLE"==this.root.tagName){var e=_(this.root).wrap("<div class='xtable'></div>");this.root=e.parent().get(0)}if(function(t){var e,i,n,o=["buffer","bufferCount","csvCount","sortLoading","sortCache","sortIndex","sortOrder","event","rows","scrollWidth","width","rowHeight","xssFilter","msort"],s=_(t.root);if("vscroll"==t.options.buffer&&(s.hasClass("nowrap")||s.addClass("nowrap")),"page"!=t.options.buffer&&(s.hasClass("scroll")||s.addClass("scroll")),s.append(s.children("table").clone()),c=z(s.children("table:first-child"),a(t,o)),_((e=c).root).wrap("<div class='head'></div>"),_(e.root).children("tbody").remove(),function(t,e){var i=e.listColumn();if("page"!=t.options.buffer){var n=t.options.scrollHeight;"vscroll"==t.options.buffer?(_(e.root).wrap("<div class='body' style='max-height: "+n+"px'><div></div></div>"),_(e.root).parent().parent().css({"overflow-y":"scroll"})):(_(e.root).wrap("<div class='body' style='max-height: "+n+"px'></div>"),_(e.root).parent().css({"overflow-y":"scroll"}))}else _(e.root).wrap("<div class='body'></div>");_(e.root).find("thead > tr").outerHeight(0).not(":last-child").remove();for(var o=0;o<i.length;o++)_(i[o].element).html("").outerHeight(0)}(t,w=z(s.children("table:last-child"),a(t,o.concat("resize")))),0<(n=(i=t).options).scrollWidth?i.scrollWidth(n.scrollWidth,!0):0<n.width&&_(i.root).outerWidth(n.width),t.options.xssFilter){var l=t.options.xssFilter,r=!0===l?c.uit.getColumnCount():l.length;p={};for(var h=0;h<r;h++){var u=!0===l?h:l[h],d=c.getColumn(u);p[d.name]=!0}}function a(t,e){var i={};for(var n in t.options)-1==_.inArray(n,e)&&(i[n]=t.options[n]);return 0<t.options.scrollWidth&&(i.resize=!1),i}}(this),r=this,c.on("colresize",function(t,e){for(var i=c.listColumn(),n=w.listColumn(),o=!1,s=i.length-1;0<=s;s--){var l=_(i[s].element).outerWidth();"page"==r.options.buffer||"show"!=i[s].type||o?(_(i[s].element).outerWidth(l),_(n[s].element).outerWidth(l)):(k.browser.msie?_(n[s].element).outerWidth(l-y(r)):_(n[s].element).css({width:"auto"}),o=!0)}x(500),r.emit("colresize",[t,e])}),c.on("colshow",function(t,e){w.uit.showColumn(t.index),r.resize(),r.emit("colshow",[t,e])}),c.on("colhide",function(t,e){w.uit.hideColumn(t.index),r.resize(),r.emit("colhide",[t,e])}),c.on("colclick",function(t,e){r.emit("colclick",[t,e])}),c.on("coldblclick",function(t,e){r.emit("coldblclick",[t,e])}),c.on("colmenu",function(t,e){r.emit("colmenu",[t,e])}),c.on("sort",function(t,e){r.sort(t.index,t.order,!1,e),r.emit("sort",[t,e])}),w.on("select",function(t,e){r.emit("select",[t,e])}),w.on("click",function(t,e){r.emit("click",[t,e])}),w.on("dblclick",function(t,e){r.emit("dblclick",[t,e])}),w.on("rowmenu",function(t,e){r.emit("rowmenu",[t,e])}),w.on("expand",function(t,e){r.emit("expand",[t,e])}),w.on("expandend",function(t,e){r.emit("expandend",[t,e])}),v(this,t.scrollWidth,t.scrollHeight),t.msort&&t.sortEvent&&function(o){for(var t=o.options.msort,e=!0===t?c.uit.getColumnCount():t.length,s=[],l=[],i=0;i<e;i++){var n=!0===t?i:t[i],r=o.getColumn(n);null!=r.element&&(function(t,n){o.addEvent(n.element,"click",function(t){if(!_(t.target).hasClass("resize")){if("asc"==n.order){n.order=null;for(var e=0;e<s.length;e++)n.name==s[e]&&(s.splice(e,1),l.splice(e,1))}else{var i=k.inArray(n.name,s);null==n.order?n.order="desc":"desc"==n.order&&(n.order="asc"),-1==i?(s.push(n.name),l.push(n.order)):l[i]=n.order}o.emit("msort",[n,t]),o.msort(s,l),o.emit("colclick",[n,t])}})}(0,r),_(r.element).css("cursor","pointer"))}}(this),t.data&&this.update(t.data),c.tpl.loading&&null!=L){var i=_(c.tpl.loading());_(this.root).append(i),n=L(i,{target:this.selector,opacity:.1,autoHide:!1}),t.sortLoading=!0===t.sortLoading?500:t.sortLoading}t.resize&&(0<t.scrollWidth?g(this):(c.resizeColumns(),c.resize()))},this.render=function(t){R(this,t),this.next()},this.select=function(t){null!=o&&_(o.element).removeClass("selected");var e=this.get(t);return null!=(o=e).element&&_(e.element).addClass("selected"),e},this.unselect=function(){null!=o&&(_(o.element).removeClass("selected"),o=null)},this.update=function(t){this.reset(),u=m(t,0,null),this.render(),this.emit("update"),c.emit("colresize"),this.options.sortIndex&&(this.options.sort?this.sort(this.options.sortIndex,this.options.sortOrder,!0):this.options.msort&&this.msort(this.options.sortIndex,this.options.sortOrder,!0))},this.updateTree=function(t){this.reset();for(var e=0;e<t.length;e++){var i=s.getParentIndex(t[e].index);if(null==i)u.push(m([t[e].data],0,null,t[e].type)[0]);else{var n=this.get(i);n&&b(n,t[e].data,t[e].type)}}this.render(!0),this.emit("updateTree")},this.append=function(t,e){var i=this.get(t);i&&(b(i,e),this.clear(),this.render(!0),this.emit("append"))},this.open=function(t){var e=this.get(t);e&&(e.type="open",this.clear(),this.render(!0),this.emit("open",[e]))},this.fold=function(t){var e=this.get(t);e&&(e.type="fold",this.clear(),this.render(!0),this.emit("fold",[e]))},this.openAll=function(t){var e=[];if(this.findAll(t,e),e){for(var i=0,n=e.length;i<n;i++)e[i].type="open";this.clear(),this.render(!0),this.emit("openall")}},this.foldAll=function(t){var e=[];if(this.findAll(t,e),e){for(var i=0,n=e.length;i<n;i++)e[i].type="fold";this.clear(),this.render(!0),this.emit("foldall")}},this.next=function(){var t,e=(r-1)*this.options.bufferCount,i=e+this.options.bufferCount;if("vscroll"==this.options.buffer&&(w.reset(),C.start_index<C.end_index&&(e=C.start_index,i=C.end_index),((t=C).start_index<0||isNaN(t.start_index)||t.end_index<0||isNaN(t.end_index)||t.current_row_index<0||isNaN(t.current_row_index)||t.scroll_count<0||isNaN(t.scroll_count)||t.prev_scroll_top<0||isNaN(t.prev_scroll_top))&&console.log(t)),(i=i>h.length?h.length:i)<=h.length){for(var n=[],o=e;o<i;o++){var s=h[o];s.seq=o+1,s.reload(c.uit.getColumn(),null,p),n.push(s)}w.append(n),"vscroll"!=this.options.buffer&&(this.emit("next",[r]),0<n.length&&r++)}},this.page=function(t){return"scroll"!=this.options.buffer&&"vscroll"!=this.options.buffer&&(this.getPage()!=t&&(this.clear(),r=t<1?1:t,void this.render()))},this.sort=function(t,e,i,n){if(this.options.fields&&this.options.sort&&!this.options.msort&&!a){var o=this,s=c.getColumn(t);"string"==typeof s.name&&(s.order=e||("asc"==s.order||null==s.order?"desc":"asc"),c.uit.setColumn(t,s),this.options.sortLoading&&!i?(o.showLoading(),setTimeout(function(){l()},this.options.sortLoading)):l()),this.options.sortCache&&this.setOption({sortIndex:s.index,sortOrder:s.order})}function l(){u.sort(function(t,e){return E(t.data,e.data,[s.name],[s.order],0)}),o.clear(),o.render(!0),o.emit("sortend",[s,n]),o.hideLoading()}},this.msort=function(i,n,t){if(this.options.fields&&this.options.msort&&!this.options.sort&&k.typeCheck("array",i)&&k.typeCheck("array",n)&&i.length==n.length){null==l?l=h:h=l;var e=this,o=h.slice();this.options.sortLoading&&!t?(e.showLoading(),setTimeout(function(){s()},this.options.sortLoading)):s(),this.options.sortCache&&this.setOption({sortIndex:i,sortOrder:n})}function s(){0<i.length&&o.sort(function(t,e){return E(t.data,e.data,i,n,0)}),u=o,e.clear(),e.render(!0),e.emit("msortend"),e.hideLoading(),o=null}},this.filter=function(t){null==l?l=h:h=l;for(var e=h.slice(),i=[],n=0,o=e.length;n<o;n++){var s=e[n].data;("function"==typeof t&&!0===t(s)||!t)&&i.push(s)}this.update(i),this.emit("filter",[i]),e=null},this.rollback=function(){this.filter(null),l=null},this.clear=function(){r=1,w.uit.removeRows(),w.scroll()},this.reset=function(){"vscroll"==this.options.buffer&&(_(this.root).find(".body").scrollTop(0),_(w.root).css({top:"0px"}),_(w.root).parent().css({height:"auto"}),C={height:0,content_height:0,count:0,scroll_count:0,prev_scroll_left:0,prev_scroll_top:0,current_row_index:0,start_index:0,end_index:0,is_focus:!0}),this.clear(),u=[],d=[],h=[],o=null},this.resize=function(){c.resizeColumns(),c.resize(),c.emit("colresize")},this.scrollWidth=function(t,e){if(0!=this.options.scrollWidth){var i=this.options.width;if(0<i){var n=i<=t?t-y(this):i;_(this.root).outerWidth(n)}else _(this.root).outerWidth(t-y(this));if(0<t){var o=_(this.root).outerWidth();_(this.root).outerWidth(t),e&&(_(c.root).outerWidth(o+y(this)),_(w.root).outerWidth(o),x(1e3)),_(c.root).parent().css("max-width",t),_(w.root).parent().css("max-width",t)}}},this.scrollHeight=function(t){"page"!=this.options.buffer&&(_(this.root).find(".body").css("max-height",t+"px"),this.setOption("scrollHeight",t),v(this,this.options.scrollWidth,t))},this.scrollTop=function(t,e){if("vscroll"==this.options.buffer){var i=_(this.root).children(".body");R(this,!0);for(var n=0,o=h.length;n<o;n++){if(""+t==h[n].index){var s=n*C.height,l=i.height(),r=k.typeCheck("integer",e)?e:0;l<s+r&&(s+=r),i.scrollTop(s),this.clear(),this.next();break}}}},this.height=function(t){this.scrollHeight(t)},this.size=function(){return u.length},this.count=function(){return u.length},this.list=function(){return u},this.listColumn=function(){return c.listColumn()},this.listData=function(){for(var t=[],e=0;e<u.length;e++)t.push(u[e].data);return t},this.get=function(t){if(null==t)return null;if(i=d[t])return i;for(var e=s.getIndexList(t),i=d[e[0]],n=1,o=e.length;n<o&&i;n++)i=i.children[e[n]];return i},this.findAll=function(t,e){var i=this.get(t);if(null!=i){k.typeCheck("array",e)||(e=[i]);for(var n=0;n<i.children.length;n++){var o=i.children[n];e.push(o),0<o.children.length&&this.findAll(o.index,e)}}},this.getColumn=function(t){return c.getColumn(t)},this.getData=function(t){var e=this.get(t);return e?e.data:null},this.showColumn=function(t){c.showColumn(t)},this.hideColumn=function(t){c.hideColumn(t)},this.initColumns=function(t){c.initColumns(t),w.initColumns(t),c.emit("colresize")},this.showColumnMenu=function(t,e){c.showColumnMenu(t,e)},this.hideColumnMenu=function(){c.hideColumnMenu()},this.toggleColumnMenu=function(t,e){c.toggleColumnMenu(t,e)},this.showExpand=function(t,e){w.showExpand(t,e)},this.hideExpand=function(t){t?w.hideExpand(t):w.hideExpand()},this.getExpand=function(){return w.getExpand()},this.showLoading=function(t){if(n&&!i&&(n.show(),i=!0,0<t)){var e=this;setTimeout(function(){e.hideLoading()},t)}},this.hideLoading=function(){n&&i&&(n.hide(),i=!1)},this.isLoading=function(){return i},this.setCsv=function(t){var e=this.options;if(e.fields||e.csv){var i=k.getCsvFields(e.fields,e.csv),n=e.csvNumber?k.getCsvFields(e.fields,e.csvNumber):null;this.update(k.csvToData(i,t,n))}},this.setCsvFile=function(t){if(this.options.fields||this.options.csv){var e=this;k.fileToCsv(t,function(t){e.setCsv(t)})}},this.getCsv=function(){if(this.options.fields||this.options.csv){var t=k.getCsvFields(this.options.fields,this.options.csv),e=u.length>this.options.csvCount?this.options.csvCount:u.length;return k.dataToCsv2({fields:t,rows:this.listData(),count:e,names:this.options.csvNames})}},this.getCsvBase64=function(){if(this.options.fields||this.options.csv)return k.csvToBase64(this.getCsv())},this.downloadCsv=function(t){k.typeCheck("string",t)&&(t=t.split(".")[0]);var e=document.createElement("a");e.download=t?t+".csv":"table.csv",e.href=this.getCsvBase64(),document.body.appendChild(e),e.click(),e.parentNode.removeChild(e)},this.rowFunc=function(t,e,i){if(this.options.fields){var n="function"==typeof i,o=0,s=n?0:u.length,l=c.getColumn(e);if(l.name)for(var r=0;r<u.length;r++){var h=u[r].data[l.name];isNaN(h)||(n?i(u[r])&&(o+=h,s++):o+=h)}return"sum"==t?o:"avg"==t?o/s:null}},this.getPage=function(){return r-1},this.activeIndex=function(){return o?o.index:null}};return t.setup=function(){return{fields:null,csv:null,csvNames:null,csvNumber:null,csvCount:1e4,data:[],rows:null,colshow:!1,expand:!1,expandEvent:!0,resize:!1,rowHeight:26,scrollHeight:200,scrollWidth:0,width:0,buffer:"scroll",bufferCount:100,msort:!1,sort:!1,sortLoading:!1,sortCache:!1,sortIndex:null,sortOrder:"asc",sortEvent:!0,xssFilter:!1,animate:!1}},t});