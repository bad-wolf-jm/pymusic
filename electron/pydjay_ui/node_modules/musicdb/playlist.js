const { ObjectSetController } = require("./object_set.js")


class PlaylistController extends ObjectSetController {
    constructor(db, collection, id) {
        super(db, collection, id)
    }

    async getTracks() {
        let q = this.getList()
        let tracks = await this.d.getTracksByIds(q)
        let x = {}
        tracks.forEach((t) => {x[t._id] = t})
        return q.tracks.map((t) => {return x[t]})
    }


    length() {
        let q = this.getList()
        let i = q.indexOf(null)
        return (i == -1) ? q.length : i 
    }

    duration() {
        let q = this.getList()
        return this.d.duration(q.slice(0, this.length())) 
    }

}



module.exports = {
    PlaylistController: PlaylistController
}
