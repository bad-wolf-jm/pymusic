const { ObjectListController } = require("./object_list.js")


class SessionController extends ObjectListController {
    constructor(db, collection, id) {
        super(db, collection, id)
    }

    async getAll() {
        let q = this.getList()
        let tracks = await this.d.getTracksByIds(q)
        let x = {}
        console.log(q, tracks)
        tracks.forEach((t) => {x[t._id] = t})
        return tracks.map((t) => {return x[t]})
    }

    async length() {
        let q = await this.getList()
        let i = q.indexOf(null)
        return (i == -1) ? q.length : i 
    }

    async duration() {
        let q = await this.getList()
        return this.d.duration(q.slice(0, this.length())) 
    }

}

module.exports = {
    SessionController: SessionController
}